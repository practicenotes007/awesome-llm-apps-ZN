# 🎫 带结构化输出的客户支持工单代理

一个演示如何使用Google的ADK（代理开发工具包）框架实现结构化客户支持工单系统的教程。此示例展示了如何使用Pydantic模式和Gemini 2.0 Flash模型创建类型安全的结构化工单，包含优先级、类别和解决时间估算。

## 教程特点

- 🎫 **结构化工单**：
  - 学习如何创建全面的工单模式
  - 理解优先级和分类
  - 查看如何估算解决时间

- 🔧 **高级模式设计**：
  - 带枚举和可选字段的复杂Pydantic模型
  - 正确的字段验证和描述
  - 类型安全的结构化响应

- 🎯 **实际应用**：
  - 实用的客户支持用例
  - 展示如何处理不同类型的支援请求
  - 演示业务流程的结构化输出

- 📊 **优先级管理**：
  - 四级优先级系统（低、中、高、紧急）
  - 基于问题描述的自动优先级分配
  - 基于类别的不同部门路由

## 🚀 开始使用

1. **设置环境**：
   ```bash
   cd 3_1_customer_support_ticket_agent
   
   # 复制环境模板
   cp env.example .env
   
   # 编辑.env并添加您的Google AI API密钥
   # 从以下网址获取API密钥：https://aistudio.google.com/
   ```

2. **安装依赖项**：
   ```bash
   # 导航回目录
   cd ..

   # 安装所需包
   pip install -r requirements.txt
   ```

3. **运行代理**
   ```bash
   # 启动ADK Web界面
   adk web
   ```
   然后：
   1. 在浏览器中打开Web界面
   2. 选择"support_ticket_creator"代理
   3. 输入您的支持请求（例如，"我无法登录账户，2小时后有个重要会议"）
   4. 响应将是包含所有工单详情的结构化JSON

## 教程概述

本教程演示了Google ADK中的高级结构化输出实现：

1. **复杂模式设计**：学习如何创建复杂的Pydantic模型
2. **枚举使用**：理解如何使用枚举约束值
3. **可选字段**：查看如何使用适当的默认值处理可选数据
4. **业务逻辑**：学习如何实现实际的业务流程

## 代码结构

- `customer_support_agent/agent.py`：包含主要代理定义和支持工单模式
- `customer_support_agent/__init__.py`：模块初始化以便轻松导入

## 支持工单模式

代理创建包含以下字段的结构化工单：

- **title**：问题的简明摘要
- **description**：详细的问题描述
- **priority**：优先级（低、中、高、紧急）
- **category**：部门（技术、账单、账户、产品）
- **steps_to_reproduce**：可选的技术问题重现步骤列表
- **estimated_resolution_time**：预计解决时间

## 使用示例

**输入**："我的付款失败了，同一服务被收取了两次费用"

**输出**：
```json
{
  "title": "重复收费问题",
  "description": "客户报告付款失败，随后同一服务被重复收费",
  "priority": "high",
  "category": "Billing",
  "steps_to_reproduce": null,
  "estimated_resolution_time": "4-6小时"
}
```

## 依赖项

- `google-adk`：Google的代理开发工具包
- `pydantic`：数据验证和设置管理

## 结构化输出工作原理

本教程展示了Google ADK如何处理复杂的结构化输出：

1. **输入处理**：接收自然语言支持请求
2. **上下文分析**：分析问题严重性和类型
3. **结构化生成**：创建包含所有必填字段的全面工单
4. **验证**：确保输出与定义的模式和业务规则匹配

这种方法演示了如何在Google ADK应用程序中创建可靠、适用于业务的结构化响应。