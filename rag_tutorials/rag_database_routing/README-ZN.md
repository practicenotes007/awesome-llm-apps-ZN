# 📠 带数据库路由的RAG代理

一个Streamlit应用程序，展示了带智能查询路由的RAG代理的高级实现。该系统将多个专业数据库与智能回退机制相结合，以确保对用户查询提供可靠和准确的响应。

## 功能特性

- **文档上传**：用户可以上传与特定公司相关的多个PDF文档。这些文档被处理并存储在三个数据库之一中：产品信息、客户支持与常见问题解答或财务信息。

- **自然语言查询**：用户可以用自然语言提问。系统使用agno代理作为路由器自动将查询路由到最相关的数据库。

- **RAG编排**：利用Langchain编排检索增强生成过程，确保检索到最相关的信息并呈现给用户。

- **回退机制**：如果在数据库中未找到相关文档，则使用带DuckDuckGo搜索工具的LangGraph代理进行网络研究并提供答案。

## 如何运行？

1. **克隆仓库**：
   ```bash
   git clone https://github.com/Shubhamsaboo/awesome-llm-apps.git
   cd rag_tutorials/rag_database_routing
   ```

2. **安装依赖**：
   ```bash
   pip install -r requirements.txt
   ```

3. **运行应用程序**：
   ```bash
   streamlit run rag_database_routing.py
   ```

4. **获取OpenAI API密钥**：获取OpenAI API密钥并在应用程序中设置。这需要用于初始化应用程序中使用的语言模型。

5. **设置Qdrant云**
- 访问[Qdrant云](https://cloud.qdrant.io/)
- 创建账户或登录
- 创建新集群
- 获取您的凭证：
   - Qdrant API密钥：在API密钥部分找到
   - Qdrant URL：您的集群URL（格式：https://xxx-xxx.aws.cloud.qdrant.io）

5. **上传文档**：使用文档上传部分将PDF文档添加到所需数据库。

6. **提出问题**：在查询部分输入您的问题。应用程序会将您的问题路由到适当的数据库并提供答案。

## 使用的技术

- **Langchain**：用于RAG编排，确保高效的信息检索和生成。
- **Agno代理**：用作路由器代理，确定给定查询的最相关数据库。
- **LangGraph代理**：作为回退机制，在必要时利用DuckDuckGo进行网络研究。
- **Streamlit**：为文档上传和查询提供用户友好的界面。
- **Qdrant**：用于管理数据库，高效地存储和检索文档嵌入。

## 工作原理？

**1. 查询路由**
系统使用三阶段路由方法：
- 跨所有数据库的向量相似性搜索
- 基于LLM的路由处理模糊查询
- 针对未知主题的网络搜索回退

**2. 文档处理**
- 从PDF自动提取文本
- 带重叠的智能文本分块
- 向量嵌入生成
- 高效的数据库存储

**3. 答案生成**
- 上下文感知检索
- 智能文档组合
- 基于置信度的响应
- 网络研究集成